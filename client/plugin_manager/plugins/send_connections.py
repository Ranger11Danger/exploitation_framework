from plugin_manager.manager import plugin_manager
from cmd2 import with_argparser
import argparse
import socket
import threading
import json
from collections import namedtuple
from libs.comm import my_proto, send_msg
argparser = argparse.ArgumentParser()
argparser.add_argument('-d', help="data to send", required=True)
argparser.add_argument('-t', help="type of message", required=True)


class test(plugin_manager):

    @with_argparser(argparser)
    def do_send(self, args):
        """Debug purpose only for testing features"""
        # Create our JSON object from args
        
        proto = my_proto(message_type=args.t, data=args.d, channel="1", filename="None")
        
        
        data = send_msg(self.connections[int(self.current_session)], proto)
        
        print(data.data)
       
